<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¨Ø§Ø¯Ø±Ø© Ø§Ù„Ø£Ø³ØªØ§Ø°Ø© ØºØ§Ø¯Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ | Ù…Ù†ØµØ© Ø§Ù„ØªØ­Ø¯ÙŠ</title>
    <style>
        :root { --primary: #1a2a6c; --gold: #d4af37; --bg: #f8f9fa; --success: #27ae60; --fail: #e74c3c; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); margin: 0; padding: 20px; min-height: 100vh; }
        .app-container { width: 100%; max-width: 950px; background: white; border-radius: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.2); margin: auto; overflow: hidden; border: 4px solid var(--primary); }
        .header { background: var(--primary); color: white; padding: 25px; text-align: center; border-bottom: 5px solid var(--gold); }
        .screen { padding: 30px; display: none; text-align: center; animation: fadeIn 0.5s; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø«Ù„Ø§Ø«Ø© */
        .classes-setup { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px; }
        .class-card { background: #fff; padding: 20px; border-radius: 15px; border: 2px solid #eee; transition: 0.3s; }
        .class-card:hover { border-color: var(--gold); transform: translateY(-5px); }
        textarea { width: 100%; height: 150px; border-radius: 10px; padding: 10px; border: 1px solid #ccc; margin: 10px 0; resize: none; font-size: 0.9rem; }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨ */
        .timer-box { font-size: 2.5rem; font-weight: bold; color: var(--fail); margin: 15px 0; font-family: 'Courier New', Courier, monospace; }
        .riddle-card { background: #fff; border-right: 12px solid var(--gold); padding: 35px; border-radius: 20px; font-size: 1.8rem; color: var(--primary); margin: 25px 0; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        
        .btn { padding: 12px 25px; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; transition: 0.3s; margin: 5px; font-size: 1.1rem; }
        .btn-gold { background: var(--gold); color: white; }
        .btn-blue { background: var(--primary); color: white; }
        .btn-time { background: #636e72; color: white; }
        .btn-correct { background: var(--success); color: white; }
        .btn-wrong { background: var(--fail); color: white; }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø«Ù†Ø§Ø¡ ÙˆØ§Ù„ØªØ­ÙÙŠØ² */
        #feedbackMessage { font-size: 1.5rem; font-weight: bold; margin: 15px 0; min-height: 40px; }
        .text-success { color: var(--success); }
        .text-fail { color: var(--fail); }

        .score-table { width: 100%; border-collapse: collapse; margin-top: 20px; border-radius: 15px; overflow: hidden; }
        .score-table th { background: var(--primary); color: white; padding: 15px; }
        .score-table td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <h1>Ù…Ø¨Ø§Ø¯Ø±Ø© Ø§Ù„Ø£Ø³ØªØ§Ø°Ø© ØºØ§Ø¯Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ</h1>
        <h3>Ù…Ù†ØµØ© Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„Ù„ØºÙˆÙŠ Ø§Ù„Ø°ÙƒÙŠØ© ğŸ’¡</h3>
    </div>

    <div id="setup-screen" class="screen active">
        <h2 style="color:var(--primary)">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h2>
        <div class="classes-setup">
            <div class="class-card">
                <h3>Ø§Ù„ÙØµÙ„ (Ø£)</h3>
                <textarea id="list-A" placeholder="Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø·Ù„Ø§Ø¨ Ø§Ù„ÙØµÙ„ Ø£ (Ø§Ø³Ù… ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)..."></textarea>
            </div>
            <div class="class-card">
                <h3>Ø§Ù„ÙØµÙ„ (Ø¨)</h3>
                <textarea id="list-B" placeholder="Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø·Ù„Ø§Ø¨ Ø§Ù„ÙØµÙ„ Ø¨ (Ø§Ø³Ù… ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)..."></textarea>
            </div>
            <div class="class-card">
                <h3>Ø§Ù„ÙØµÙ„ (Ø¬)</h3>
                <textarea id="list-C" placeholder="Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø·Ù„Ø§Ø¨ Ø§Ù„ÙØµÙ„ Ø¬ (Ø§Ø³Ù… ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)..."></textarea>
            </div>
        </div>
        <button class="btn btn-gold" style="width: 80%; margin-top: 30px;" onclick="saveAndGo()">Ø­ÙØ¸ Ø§Ù„ÙØµÙˆÙ„ ÙˆØ§Ù„Ø¨Ø¯Ø¡ âœ¨</button>
    </div>

    <div id="mode-screen" class="screen">
        <h2>Ø¬Ø§Ù‡Ø²ÙˆÙ† Ù„Ù„ØªØ­Ø¯ÙŠØŸ ğŸ¯</h2>
        <p>Ø§Ø®ØªØ± Ø§Ù„ÙØµÙ„ ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø®ØµØµ Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„:</p>
        <select id="activeClassSelect" style="padding:10px; border-radius:10px; width:200px; font-size:1.1rem;"></select>
        <div style="margin: 20px 0;">
            <button class="btn btn-time" id="t30" onclick="setTimer(30)">â³ 30 Ø«Ø§Ù†ÙŠØ©</button>
            <button class="btn btn-time" id="t60" onclick="setTimer(60)">â³ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©</button>
        </div>
        <button class="btn btn-gold" style="width: 200px;" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† ğŸš€</button>
    </div>

    <div id="game-screen" class="screen">
        <div id="timerDisplay" class="timer-box">00:30</div>
        <div style="font-size: 1.4rem;">Ø¯ÙˆØ± Ø§Ù„Ø·Ø§Ù„Ø¨: <b id="currentPlayerName" style="color:var(--gold)">--</b></div>
        
        <div class="riddle-card" id="riddleText">...</div>
        
        <button class="btn btn-blue" id="revealBtn" onclick="revealAnswer()">ÙƒØ´Ù Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© âœ…</button>
        
        <div id="answerSection" style="display:none;">
            <div id="feedbackMessage"></div>
            <div style="font-size: 1.6rem; color: var(--success); font-weight: bold;">Ø£Ù†Ø§: <span id="correctAnswer"></span></div>
            <div id="synAntDisplay" style="margin: 15px 0; background:#f9f9f9; padding:15px; border-radius:15px;"></div>
            
            <div style="display:flex; gap:10px; justify-content: center;">
                <button class="btn btn-correct" onclick="handleResult(true)">âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</button>
                <button class="btn btn-wrong" onclick="handleResult(false)">âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©</button>
            </div>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <h2 id="resultHeader">Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù ğŸ†</h2>
        <table class="score-table">
            <thead>
                <tr><th>Ø§Ù„Ù…Ø±ÙƒØ²</th><th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th></tr>
            </thead>
            <tbody id="scoreBody"></tbody>
        </table>
        <br>
        <button class="btn btn-gold" onclick="location.reload()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ğŸ”„</button>
    </div>
</div>

<script>
    let classes = { 'Ø£': [], 'Ø¨': [], 'Ø¬': [] };
    let activeClassName = '';
    let students = [];
    let currentStudentIdx = 0;
    let currentRiddleIdx = 0;
    let timeLimit = 30;
    let timerInterval;

    const riddles = [
        { q: "Ø£Ù†Ø§ Ø¨ÙŠØª Ø§Ù„Ø£Ø³Ø¯ Ø§Ù„Ù‚ÙˆÙŠØŒ Ø£Ø®ØªØ¨Ø¦ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø´Ø¬Ø§Ø±.. ÙÙ…Ù† Ø£Ù†Ø§ØŸ", a: "Ø¹Ø±ÙŠÙ†", s: "Ù…Ø£ÙˆÙ‰ / Ù…Ø³ÙƒÙ†", ant: "Ø®Ù„Ø§Ø¡" },
        { q: "Ø£Ù†Ø§ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø¹Ø·Ø§Ø¡ Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¨Ù‡ Ø§Ù„Ø¬Ù…ÙŠØ¹.. ÙÙ…Ù† Ø£Ù†Ø§ØŸ", a: "ÙƒØ±ÙŠÙ…", s: "Ø³Ø®ÙŠ / Ø¬ÙˆØ§Ø¯", ant: "Ø¨Ø®ÙŠÙ„" },
        { q: "Ø£Ù†Ø§ ÙˆÙ‚Øª ÙŠØ±Ø­Ù„ ÙÙŠÙ‡ Ø§Ù„Ø¶ÙˆØ¡ ÙˆØªØ¸Ù‡Ø± ÙÙŠÙ‡ Ø§Ù„Ù†Ø¬ÙˆÙ….. ÙÙ…Ù† Ø£Ù†Ø§ØŸ", a: "Ø§Ù„Ù„ÙŠÙ„", s: "Ø§Ù„Ø¸Ù„Ø§Ù… / Ø§Ù„Ø¹ØªÙ…Ø©", ant: "Ø§Ù„Ù†Ù‡Ø§Ø±" },
        { q: "Ø£Ù†Ø§ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ ÙˆØ§Ù„Ø³Ù…Ùˆ ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù†Ø© ÙˆØ§Ù„Ø¹Ù„Ù….. ÙÙ…Ù† Ø£Ù†Ø§ØŸ", a: "Ø¹Ù„Ùˆ", s: "Ø±ÙØ¹Ø© / Ø³Ù…Ùˆ", ant: "Ø§Ù†Ø®ÙØ§Ø¶" },
        { q: "Ø£Ù†Ø§ Ø§Ù„Ø¹Ù„Ù… Ø§Ù„Ø°ÙŠ ÙŠÙ†ÙŠØ± Ø¹Ù‚ÙˆÙ„ Ø§Ù„Ø¨Ø´Ø±.. ÙÙ…Ù† Ø£Ù†Ø§ØŸ", a: "Ù†ÙˆØ±", s: "Ø¶ÙŠØ§Ø¡ / Ø¥Ø´Ø±Ø§Ù‚", ant: "Ø¬Ù‡Ù„ / Ø¸Ù„Ø§Ù…" }
        // ÙŠÙ…ÙƒÙ† Ù„Ù„Ø£Ø³ØªØ§Ø°Ø© ØºØ§Ø¯Ø© Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø£Ù„ØºØ§Ø² Ù‡Ù†Ø§ Ø­ØªÙ‰ 100 Ø¨Ù†ÙØ³ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚
    ];

    const praiseWords = ["Ø±Ø§Ø¦Ø¹ ÙŠØ§ Ø¨Ø·Ù„! ğŸŒŸ", "Ø¥Ø¬Ø§Ø¨Ø© Ø°ÙƒÙŠØ© Ø¬Ø¯Ø§Ù‹! âœ¨", "Ù…Ø¨Ø¯Ø¹ØŒ Ø§Ø³ØªÙ…Ø± ÙÙŠ ØªØ£Ù„Ù‚Ùƒ! ğŸ†", "Ø£Ø­Ø³Ù†Øª Ø§Ù„Ù‚ÙˆÙ„ ÙˆØ§Ù„Ø¹Ù…Ù„! âœ…"];
    const encourageWords = ["Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŒ Ø£Ù†Øª ØªØ³ØªØ·ÙŠØ¹! ğŸ’ª", "Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ø§Ù‹ØŒ Ø±ÙƒØ² ÙÙŠ Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©! ğŸ”", "Ù„Ø§ Ø¨Ø£Ø³ØŒ Ø§Ù„Ø¹Ù„Ù… ÙŠØ­ØªØ§Ø¬ Ù…Ø­Ø§ÙˆÙ„Ø§Øª! ğŸŒ±", "ÙƒÙ†Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹ØŒ Ø§Ù„Ù‚Ø§Ø¯Ù… Ø£ÙØ¶Ù„! ğŸš€"];

    function saveAndGo() {
        classes['Ø£'] = document.getElementById('list-A').value.split('\n').filter(n => n.trim());
        classes['Ø¨'] = document.getElementById('list-B').value.split('\n').filter(n => n.trim());
        classes['Ø¬'] = document.getElementById('list-C').value.split('\n').filter(n => n.trim());
        
        let select = document.getElementById('activeClassSelect');
        select.innerHTML = '';
        Object.keys(classes).forEach(k => {
            if(classes[k].length > 0) select.innerHTML += `<option value="${k}">ÙØµÙ„ (${k})</option>`;
        });

        if(select.innerHTML === '') return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ø³Ù…Ø§Ø¡ ÙÙŠ ÙØµÙ„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
        showScreen('mode-screen');
    }

    function setTimer(sec) {
        timeLimit = sec;
        document.querySelectorAll('.btn-time').forEach(b => b.style.border = "none");
        document.getElementById('t' + sec).style.border = "3px solid var(--gold)";
    }

    function startGame() {
        activeClassName = document.getElementById('activeClassSelect').value;
        students = classes[activeClassName].map(name => ({ name, score: 0 }));
        showScreen('game-screen');
        nextRiddle();
    }

    function nextRiddle() {
        if(currentRiddleIdx >= riddles.length) return showResults();
        
        document.getElementById('currentPlayerName').innerText = students[currentStudentIdx].name;
        document.getElementById('riddleText').innerText = riddles[currentRiddleIdx].q;
        document.getElementById('answerSection').style.display = 'none';
        document.getElementById('revealBtn').style.display = 'inline-block';
        document.getElementById('feedbackMessage').innerText = '';
        
        startTimer();
    }

    function startTimer() {
        let timeLeft = timeLimit;
        clearInterval(timerInterval);
        const display = document.getElementById('timerDisplay');
        
        timerInterval = setInterval(() => {
            let mins = Math.floor(timeLeft / 60);
            let secs = timeLeft % 60;
            display.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if(timeLeft <= 0) {
                clearInterval(timerInterval);
                display.innerText = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!";
            }
            timeLeft--;
        }, 1000);
    }

    function revealAnswer() {
        clearInterval(timerInterval);
        const r = riddles[currentRiddleIdx];
        document.getElementById('correctAnswer').innerText = r.a;
        document.getElementById('synAntDisplay').innerHTML = `<b>Ø§Ù„Ù…ØªØ±Ø§Ø¯Ù:</b> ${r.s} | <b>Ø§Ù„Ø¶Ø¯:</b> ${r.ant}`;
        document.getElementById('answerSection').style.display = 'block';
        document.getElementById('revealBtn').style.display = 'none';
    }

    function handleResult(isCorrect) {
        const msgBox = document.getElementById('feedbackMessage');
        if(isCorrect) {
            students[currentStudentIdx].score++;
            msgBox.className = "text-success";
            msgBox.innerText = praiseWords[Math.floor(Math.random() * praiseWords.length)];
        } else {
            msgBox.className = "text-fail";
            msgBox.innerText = encourageWords[Math.floor(Math.random() * encourageWords.length)];
        }

        setTimeout(() => {
            currentRiddleIdx++;
            currentStudentIdx = (currentStudentIdx + 1) % students.length;
            nextRiddle();
        }, 2000);
    }

    function showResults() {
        showScreen('result-screen');
        document.getElementById('resultHeader').innerText = `Ù„ÙˆØ­Ø© Ø´Ø±Ù ÙØµÙ„ (${activeClassName}) ğŸ†`;
        students.sort((a,b) => b.score - a.score);
        const body = document.getElementById('scoreBody');
        body.innerHTML = students.map((s, i) => `
            <tr>
                <td>${i+1}</td>
                <td>${s.name} ${(i===0)?'ğŸ¥‡':(i===1)?'ğŸ¥ˆ':(i===2)?'ğŸ¥‰':''}</td>
                <td>${s.score}</td>
            </tr>
        `).join('');
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }
</script>

</body>
</html>
